flows:
  make_booking:
    description: >
      Scenario 1: Help callers make a NEW booking at Ivy Gate B&B.
      Collect number of guests and stay dates, check availability, let them
      choose a room and breakfast option, summarise the total price, then
      ONLY create the booking after explicit final confirmation.
    steps:
      - collect: num_guests
        description: >
          Number of people staying. Must be a positive number between 1-10.
          If the caller provides an invalid value (negative, zero, or non-number),
          explain the issue and ask again politely.
        utter: utter_ask_num_guests
        rejections:
          - if: "slots.num_guests < 1.0 or slots.num_guests > 10.0"
            utter: utter_invalid_guest_count

      - collect: check_in_date
        description: >
          Desired check-in date. Must be today or in the future.
        utter: utter_ask_check_in_date

      - collect: check_out_date
        description: >
          Desired check-out date. Must be after check-in date.
        utter: utter_ask_check_out_date

      - collect: guest_name
        description: >
          Full name to put the booking under.
        utter: utter_ask_guest_name

      - collect: include_breakfast
        description: >
          Whether the guest wants breakfast included with their stay.
        utter: utter_ask_include_breakfast

      #- collect: preferred_room
      #  description: >
      #    Ask in one turn about room preferences like view, bed type,
      #    bathroom type (shower or bath), maximum price per night, whether
      #    they want breakfast included, and any specific room name.
      #    Use the LLM to fill the following slots *if mentioned*:
      #    - preferred_view
      #    - preferred_bed_type
      #    - preferred_bathroom_type
      #    - max_price_per_night
      #    - preferred_room
      #    Leave any of these slots empty if the user doesn't specify them.
      #  utter: utter_ask_preferred_room

      - action: action_get_available_room
        next:
          - if: "slots.room_available == true"
            then:
              - action: utter_room_assignment
              - action: action_summarize_booking
              - collect: confirm_booking
                description: >
                  Final YES/NO confirmation from the caller.
                utter: utter_ask_confirm_booking
                next:
                  - if: "slots.confirm_booking == True"
                    then:
                      - action: action_make_booking
                      - action: utter_booking_complete
                        next: END
                  - else:
                    - action: utter_booking_not_confirmed
                      next: END
          - else:
            - action: utter_no_available_rooms
              next: END

  lookup_booking:
    description: >
      Scenario 2: Help callers find and get information about an existing booking.
    steps:
      - collect: booking_id_lookup
        description: >
          Booking ID or guest name to look up the existing booking.
        utter: utter_ask_booking_id_lookup

      - action: action_lookup_booking

      - action: utter_booking_info
